/*! For license information please see vttparser.js.LICENSE.txt */
"use strict";(self.webpackChunkjwplayer=self.webpackChunkjwplayer||[]).push([[347],{2906:function(e,t,r){r.r(t);var n=r(1909),a=r(6840),i=/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/,s=/^-?\d+$/,u=/\r\n|\n/,o=/^NOTE($|[ \t])/,c=/^[^\sa-zA-Z-]+/,l=/:/,f=/\s/,h=/^\s+/,g=/-->/,d=/^WEBVTT([ \t].*)?$/,p=function(e,t,r){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new b,this.syncCueParsing=r,this.regionList=[],this.maxCueBatch=1e3};function b(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}}function v(){this.values=Object.create(null)}v.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){s.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return(t=parseFloat(t))>=0&&t<=100&&(this.set(e,t),!0)}};var E=new a.Z(0,0,0),T="middle"===E.align?"middle":"center";function w(e,t,r){var n=e;function a(){var t=function(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(i);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(c,""),t}function s(){e=e.replace(h,"")}if(s(),t.startTime=a(),s(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),s(),t.endTime=a(),s(),function(e,t){var n=new v;!function(e,t,r,n){for(var a=e.split(n),i=0;i<=a.length;i+=1)if("string"==typeof a[i]){var s=a[i].split(r);2===s.length&&t(s[0],s[1])}}(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),s=i[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",T,"end"]);break;case"position":var u=t.split(",");n.percent(e,u[0]),2===u.length&&n.alt("positionAlign",u[1],["start",T,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",T,"end","left","right"])}}),l,f),t.region=n.get("region",null),t.vertical=n.get("vertical","");var a=n.get("line","auto");"auto"===a&&-1===E.line&&(a=-1),t.line=a,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",T);var i=n.get("position","auto");"auto"===i&&50===E.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(e,t)}p.prototype={parse:function(e,t){var r,i=this;function s(){for(var e=i.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,i.buffer=e.substr(t),r}function c(){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{if("INITIAL"===i.state){if(!u.test(i.buffer))return this;var f=(r=s()).match(d);if(!f||!f[0])throw new Error("Malformed WebVTT signature.");i.state="HEADER"}}catch(e){return c(),this}var h=!1,p=0;!function e(){try{for(;i.buffer&&(p<=i.maxCueBatch||i.syncCueParsing);){if(!u.test(i.buffer))return i.flush(),this;switch(h?h=!1:r=s(),i.state){case"HEADER":l.test(r)||r||(i.state="ID");break;case"NOTE":r||(i.state="ID");break;case"ID":if(o.test(r)){i.state="NOTE";break}if(!r)break;if(i.cue=new a.Z(0,0,""),i.state="CUE",!g.test(r)){i.cue.id=r;break}case"CUE":try{w(r,i.cue,i.regionList)}catch(e){i.cue=null,i.state="BADCUE";break}i.state="CUETEXT";break;case"CUETEXT":var f=g.test(r);if(!r||f&&(h=!0)){i.oncue&&(p+=1,i.oncue(i.cue)),i.cue=null,i.state="ID";break}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=r;break;case"BADCUE":r||(i.state="ID")}}if(p=0,i.buffer)(0,n.U)(e);else if(!t)return i.flush(),this}catch(e){return c(),this}}()},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse(void 0,!0)),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}},t.default=p}}]);